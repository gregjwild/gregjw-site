<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Greg J. Wild | How I added sort-by-date to the blog</title><link rel="preconnect" href="https://fonts.gstatic.com"/><link href="https://fonts.googleapis.com/css2?family=Playfair+Display&amp;display=swap" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&amp;display=swap" rel="stylesheet"/><link rel="preload" href="/_next/static/css/dd68c624c89f2977bbfb.css" as="style"/><link rel="stylesheet" href="/_next/static/css/dd68c624c89f2977bbfb.css" data-n-g=""/><link rel="preload" href="/_next/static/css/3a811ea70c856bfedc4d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3a811ea70c856bfedc4d.css" data-n-p=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/_next/static/chunks/main-d283b4ab393ebd284c3e.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.9707fddd9ae5927c17c3.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.e3c12cb767780eaa6561.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-40461a9590cfa7d8c311.js" as="script"/><link rel="preload" href="/_next/static/chunks/3425e8918f7e08358e78c23bab4cdd9d7afa0876.a02b12a47c1b41378212.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5Bpostname%5D-00c49b1eae22d2c7e772.js" as="script"/></head><body><div id="__next"><header class="Header_header__260ft"><h1>Greg J. Wild</h1><nav><a class="Header_navItem__27E-S" href="/">Home</a><a class="Header_navItem__27E-S" href="/blog">Blog</a></nav></header><main class="Home_main__1x8gC"><section><div><article><h1>How I added sort-by-date to the blog</h1><p>First Published: <!-- -->2020-11-17</p><p>Last Updated: <!-- -->2020-11-24</p><hr/><div><p>I&#x27;d scoped out adding a sort-by-date to be a quick 30 minute addition to the blog. In the end it took a little longer, due to some unforseen complications about how I misunderstood how Next/React handles data.</p><p>In short, I&#x27;d hoped that I would be able to add a quick sort function to the PostList component that renders the blog articles in list form. It proved to be a little more complicated than I expected. The components would only accept serializable content (i.e. something that converts to JSON). The problem was, I was trying to convert my dates to a JavaScript date object, and pass that through the components. This wasn&#x27;t going to work!</p><p>In the end, I had to add the code to the blog page component.</p><p>The first thing I did was write a quick function to take the post data, and use the date string from the markdown headers such as &quot;2020-11-17&quot;, and convert this to a Date Object.</p><pre><code>const postsWithDatesConverted = postsRaw =&gt; {
    return postsRaw.map(post =&gt; {
        post.frontmatter.date = new Date(post.frontmatter.date);
        return post;
    });
}</code></pre><p>Next I needed to sort by date - without it, the list would appear in an order that made no sense at all. An interesting issue I ran into was mutating the data in place when using sort. This again lead to a strange looking sort. To prevent this, a <code>slice()</code> of the whole array returns a copy of it for us to work with. Finally, I needed to reverse the array to prevent it being sorted oldest-first.</p><pre><code>const postsSorted = postsWithDatesConverted(postsRaw)
    .slice()
    .sort((a, b) =&gt; a.frontmatter.date - b.frontmatter.date)
    .reverse()</code></pre><p>Finally, to prevent the problem I mentioned with the components requiring serializable content, I converted the date to a string - I only wanted the date information anyway!</p><pre><code>const posts = postsSorted.map(post =&gt; {
    post.frontmatter.date = post.frontmatter.date.toISOString().slice(0,10)
    return post
})</code></pre><p><a href="https://github.com/gregjwild/gregjw-site/commit/d0318643b73c2411bc1159edd996624c21fcb460">Check out the git commit</a> if you&#x27;re interested in seeing the rest of the site&#x27;s code.</p><p>Update:</p><p>I happened to get chatting about the code I&#x27;d written to deal with sorting in place. There&#x27;s no <em>real</em> need to change it, but realized I could use a spread operator instead. So, let&#x27;s do that!</p><pre><code>const postsSorted = [...postsWithDatesConverted(postsRaw)]
    .sort((a, b) =&gt; a.frontmatter.date - b.frontmatter.date)
    .reverse()</code></pre></div></article><a href="/">Back to post list</a></div></section></main><footer class="Home_footer__1WdhD"><p>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"> Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.</a>i.e. feel free to use it, modify it, and share it, but please attribute it to me, and use this license yourself. If by some small chance you think there&#x27;s a way to monetize anything, let&#x27;s talk!</p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"/></a></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"siteTitle":"Greg J. Wild","frontmatter":{"title":"How I added sort-by-date to the blog","date":"2020-11-17","updated":"2020-11-24","status":"published","summary":"A quick summary of where I ran into trouble when adding sort by date to the blog","tags":"technical-notes","rated":"boring"},"markdownBody":"I'd scoped out adding a sort-by-date to be a quick 30 minute addition to the blog. In the end it took a little longer, due to some unforseen complications about how I misunderstood how Next/React handles data.\r\n\r\nIn short, I'd hoped that I would be able to add a quick sort function to the PostList component that renders the blog articles in list form. It proved to be a little more complicated than I expected. The components would only accept serializable content (i.e. something that converts to JSON). The problem was, I was trying to convert my dates to a JavaScript date object, and pass that through the components. This wasn't going to work!\r\n\r\nIn the end, I had to add the code to the blog page component. \r\n\r\nThe first thing I did was write a quick function to take the post data, and use the date string from the markdown headers such as \"2020-11-17\", and convert this to a Date Object.\r\n\r\n    const postsWithDatesConverted = postsRaw =\u003e {\r\n        return postsRaw.map(post =\u003e {\r\n            post.frontmatter.date = new Date(post.frontmatter.date);\r\n            return post;\r\n        });\r\n    }\r\n\r\nNext I needed to sort by date - without it, the list would appear in an order that made no sense at all. An interesting issue I ran into was mutating the data in place when using sort. This again lead to a strange looking sort. To prevent this, a `slice()` of the whole array returns a copy of it for us to work with. Finally, I needed to reverse the array to prevent it being sorted oldest-first.\r\n\r\n    const postsSorted = postsWithDatesConverted(postsRaw)\r\n        .slice()\r\n        .sort((a, b) =\u003e a.frontmatter.date - b.frontmatter.date)\r\n        .reverse()\r\n\r\nFinally, to prevent the problem I mentioned with the components requiring serializable content, I converted the date to a string - I only wanted the date information anyway!\r\n\r\n    const posts = postsSorted.map(post =\u003e {\r\n        post.frontmatter.date = post.frontmatter.date.toISOString().slice(0,10)\r\n        return post\r\n    })\r\n\r\n[Check out the git commit](https://github.com/gregjwild/gregjw-site/commit/d0318643b73c2411bc1159edd996624c21fcb460) if you're interested in seeing the rest of the site's code.\r\n\r\nUpdate:\r\n\r\nI happened to get chatting about the code I'd written to deal with sorting in place. There's no _real_ need to change it, but realized I could use a spread operator instead. So, let's do that! \r\n\r\n    const postsSorted = [...postsWithDatesConverted(postsRaw)]\r\n        .sort((a, b) =\u003e a.frontmatter.date - b.frontmatter.date)\r\n        .reverse()"},"__N_SSG":true},"page":"/blog/[postname]","query":{"postname":"adding-sort-by-date-to-blog"},"buildId":"w9iOhNIbo01jHoVlzz0sU","runtimeConfig":{},"nextExport":false,"isFallback":false,"gsp":true,"head":[["meta",{"charSet":"utf-8"}],["meta",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["title",{"children":"Greg J. Wild | How I added sort-by-date to the blog"}],["link",{"rel":"preconnect","href":"https://fonts.gstatic.com"}],["link",{"href":"https://fonts.googleapis.com/css2?family=Playfair+Display\u0026display=swap","rel":"stylesheet"}],["link",{"href":"https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900\u0026display=swap","rel":"stylesheet"}]]}</script><script nomodule="" src="/_next/static/chunks/polyfills-fa276ba060a4a8ac7eef.js"></script><script src="/_next/static/chunks/main-d283b4ab393ebd284c3e.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.9707fddd9ae5927c17c3.js" async=""></script><script src="/_next/static/chunks/commons.e3c12cb767780eaa6561.js" async=""></script><script src="/_next/static/chunks/pages/_app-40461a9590cfa7d8c311.js" async=""></script><script src="/_next/static/chunks/3425e8918f7e08358e78c23bab4cdd9d7afa0876.a02b12a47c1b41378212.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5Bpostname%5D-00c49b1eae22d2c7e772.js" async=""></script><script src="/_next/static/w9iOhNIbo01jHoVlzz0sU/_buildManifest.js" async=""></script><script src="/_next/static/w9iOhNIbo01jHoVlzz0sU/_ssgManifest.js" async=""></script></body></html>