<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Greg J. Wild | How I added sort-by-date to the blog</title><link rel="preload" href="/_next/static/css/c58244e7a3489cc6a025.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c58244e7a3489cc6a025.css" data-n-g=""/><link rel="preload" href="/_next/static/css/eaea2f18b63714119084.css" as="style"/><link rel="stylesheet" href="/_next/static/css/eaea2f18b63714119084.css" data-n-p=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/_next/static/chunks/main-d283b4ab393ebd284c3e.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.9707fddd9ae5927c17c3.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.e3c12cb767780eaa6561.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-453b8cc592611763368b.js" as="script"/><link rel="preload" href="/_next/static/chunks/3425e8918f7e08358e78c23bab4cdd9d7afa0876.16ea560e6c96e3a6a794.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5Bpostname%5D-bf25c0a2165fc0589b1b.js" as="script"/></head><body><div id="__next"><header class="Header_Header__3JIzU"><h1>Greg J. Wild</h1><nav><a class="Header_navItem__27E-S" href="/">Home</a><a class="Header_navItem__27E-S" href="/blog">Blog</a></nav></header><main style="margin:2.5% 20%"><section class="layout"><div class="content"><article><h1>How I added sort-by-date to the blog</h1><p>First Published: <!-- -->2020-11-17</p><hr/><div><p>I&#x27;d scoped out adding a sort-by-date to be a quick 30 minute addition to the blog. In the end it took a little longer, due to some unforseen complications about how I misunderstood how Next/React handles data.</p><p>In short, I&#x27;d hoped that I would be able to add a quick sort function to the PostList component that renders the blog articles in list form. It proved to be a little more complicated than I expected. The components would only accept serializable content (i.e. something that converts to JSON). The problem was, I was trying to convert my dates to a JavaScript date object, and pass that through the components. This wasn&#x27;t going to work!</p><p>In the end, I had to add the code to the blog page component.</p><p>The first thing I did was write a quick function to take the post data, and use the date string from the markdown headers such as &quot;2020-11-17&quot;, and convert this to a Date Object.</p><pre><code>const postsWithDatesConverted = postsRaw =&gt; {
    return postsRaw.map(post =&gt; {
        post.frontmatter.date = new Date(post.frontmatter.date);
        return post;
    });
}</code></pre><p>Next I needed to sort by date - without it, the list would appear in an order that made no sense at all. An interesting issue I ran into was mutating the data in place when using sort. This again lead to a strange looking sort. To prevent this, a <code>slice()</code> of the whole array returns a copy of it for us to work with. Finally, I needed to reverse the array to prevent it being sorted oldest-first.</p><pre><code>const postsSorted = postsWithDatesConverted(postsRaw)
    .slice()
    .sort((a, b) =&gt; a.frontmatter.date - b.frontmatter.date)
    .reverse()</code></pre><p>Finally, to prevent the problem I mentioned with the components requiring serializable content, I converted the date to a string - I only wanted the date information anyway!</p><pre><code>const posts = postsSorted.map(post =&gt; {
    post.frontmatter.date = post.frontmatter.date.toISOString().slice(0,10)
    return post
})</code></pre><p><a href="https://github.com/gregjwild/gregjw-site/commit/d0318643b73c2411bc1159edd996624c21fcb460">Check out the git commit</a> if you&#x27;re interested in seeing the rest of the site&#x27;s code.</p></div></article><a href="/">Back to post list</a></div></section></main><footer class="Layout_footer__cIVSd"><p>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"> Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.</a>i.e. feel free to use it, modify it, and share it, but please attribute it to me, and use this license yourself. If by some small chance you think there&#x27;s a way to monetize anything, let&#x27;s talk!</p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"/></a></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"siteTitle":"Greg J. Wild","frontmatter":{"title":"How I added sort-by-date to the blog","date":"2020-11-17","status":"published","summary":"A quick summary of where I ran into trouble when adding sort by date to the blog","tags":"technical-notes","rated":"boring"},"markdownBody":"I'd scoped out adding a sort-by-date to be a quick 30 minute addition to the blog. In the end it took a little longer, due to some unforseen complications about how I misunderstood how Next/React handles data.\r\n\r\nIn short, I'd hoped that I would be able to add a quick sort function to the PostList component that renders the blog articles in list form. It proved to be a little more complicated than I expected. The components would only accept serializable content (i.e. something that converts to JSON). The problem was, I was trying to convert my dates to a JavaScript date object, and pass that through the components. This wasn't going to work!\r\n\r\nIn the end, I had to add the code to the blog page component. \r\n\r\nThe first thing I did was write a quick function to take the post data, and use the date string from the markdown headers such as \"2020-11-17\", and convert this to a Date Object.\r\n\r\n    const postsWithDatesConverted = postsRaw =\u003e {\r\n        return postsRaw.map(post =\u003e {\r\n            post.frontmatter.date = new Date(post.frontmatter.date);\r\n            return post;\r\n        });\r\n    }\r\n\r\nNext I needed to sort by date - without it, the list would appear in an order that made no sense at all. An interesting issue I ran into was mutating the data in place when using sort. This again lead to a strange looking sort. To prevent this, a `slice()` of the whole array returns a copy of it for us to work with. Finally, I needed to reverse the array to prevent it being sorted oldest-first.\r\n\r\n    const postsSorted = postsWithDatesConverted(postsRaw)\r\n        .slice()\r\n        .sort((a, b) =\u003e a.frontmatter.date - b.frontmatter.date)\r\n        .reverse()\r\n\r\nFinally, to prevent the problem I mentioned with the components requiring serializable content, I converted the date to a string - I only wanted the date information anyway!\r\n\r\n    const posts = postsSorted.map(post =\u003e {\r\n        post.frontmatter.date = post.frontmatter.date.toISOString().slice(0,10)\r\n        return post\r\n    })\r\n\r\n[Check out the git commit](https://github.com/gregjwild/gregjw-site/commit/d0318643b73c2411bc1159edd996624c21fcb460) if you're interested in seeing the rest of the site's code."},"__N_SSG":true},"page":"/blog/[postname]","query":{"postname":"adding-sort-by-date-to-blog"},"buildId":"ckXE3fQRlBtlBzVS1F3zE","runtimeConfig":{},"nextExport":false,"isFallback":false,"gsp":true,"head":[["meta",{"charSet":"utf-8"}],["meta",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["title",{"children":"Greg J. Wild | How I added sort-by-date to the blog"}]]}</script><script nomodule="" src="/_next/static/chunks/polyfills-fa276ba060a4a8ac7eef.js"></script><script src="/_next/static/chunks/main-d283b4ab393ebd284c3e.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.9707fddd9ae5927c17c3.js" async=""></script><script src="/_next/static/chunks/commons.e3c12cb767780eaa6561.js" async=""></script><script src="/_next/static/chunks/pages/_app-453b8cc592611763368b.js" async=""></script><script src="/_next/static/chunks/3425e8918f7e08358e78c23bab4cdd9d7afa0876.16ea560e6c96e3a6a794.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5Bpostname%5D-bf25c0a2165fc0589b1b.js" async=""></script><script src="/_next/static/ckXE3fQRlBtlBzVS1F3zE/_buildManifest.js" async=""></script><script src="/_next/static/ckXE3fQRlBtlBzVS1F3zE/_ssgManifest.js" async=""></script></body></html>